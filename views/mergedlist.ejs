<!DOCTYPE html>
<html>

<head>
  <title><%- query %></title>
  <link rel='stylesheet' href='/stylesheets/style.css' />
</head>

<body>
  <h1><%- title %></h1>

  <!--QUERY 6-->
  <%
    var form6 = "";
    if (query == "Query 6"){
      form6 = `<form id="tableForm" action="/query6" method="get">
        <select class="selectpicker" data-style="btn-info" name="recipe_id">
          <optgroup label="Recipe">
            <option value="102422">102422</option>
            <option value="75452">75452</option>
            <option value="44551">44551</option>
          </optgroup>
        </select>
        <input type="submit" value="Submit" />
      </form>`;
    }
    %>
  <%- form6 %>


  <!--QUERY 7-->
  <%
    var form7 = "";
    if (query == "Query 7"){
      form7 = `<form id="tableForm" action="/query7" method="get">
        <select class="selectpicker" data-style="btn-info" name="kcal">
          <optgroup label="Calories">
            <option value="100">100</option>
            <option value="90">90</option>
            <option value="80">80</option>
          </optgroup>
        </select>
        <select class="selectpicker" data-style="btn-info" name="glucide">
          <optgroup label="Glucide">
            <option value="40">40</option>
            <option value="35">35</option>
            <option value="30">30</option>
          </optgroup>
        </select><select class="selectpicker" data-style="btn-info" name="prot">
          <optgroup label="Proteines">
            <option value="20">20</option>
            <option value="15">15</option>
            <option value="10">10</option>
          </optgroup>
        </select>
        <input type="submit" value="Submit" />
      </form>`;
    }
    %>
  <%- form7 %>


  <!--QUERY 8-->
  <%
    var form8 = "";
    if (query == "Query 8"){
      form8 = `<form id="tableForm" action="/query8" method="get">
        <select class="selectpicker" data-style="btn-info" name="nb_limit">
          <optgroup label="number of recipes">
            <option value="10">10</option>
            <option value="20">20</option>
            <option value="30">30</option>
          </optgroup>
        </select>
        <input type="submit" value="Submit" />
      </form>`;
    }
    %>
  <%- form8 %>


  <table class="container">
    <%
        var table = '';

        let keys = Object.keys(JSON.parse(JSON.stringify(mergedlist[0])));

        if (projection.length == 0){
          projection = keys;
        }

        table += '<thead><tr>'
        for (let t of keys){
          for (let proj of projection){
            if (t == proj){
              table+= '<th>'+ t +'</th>'
              break;
            }
          }
        }
        table += '</tr></thead>'

        table += '<tbody>'

        let count = 0;
        for (let res of mergedlist){
          table += "<tr>";
          for (let key of keys){
            for (let proj of projection){
              if (key == proj){
                table+= '<td>'+ res[key] +'</td>'
                break;
              }
            }
          }
          table += "</tr>"

          if (count > 100){
            break;
          }

          count++;
        }

        table += '</tbody>'
      %>
    <%- table %>
  </table>
</body>

</html>